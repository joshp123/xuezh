---
id: T-02B
title: Artifact retention policy + deterministic GC command
order: 4
depends_on: ["T-02"]
blocks: ["T-14"]
implements_commands: ["gc"]
north_stars: ["NS-3", "NS-2"]
user_requirements: ["UR-09"]
bdd: ["BDD-GC", "BDD-ZFC"]
status: done
requires_user_review: false
---

    # T-02B: Artifact retention policy + deterministic GC command

    ## Goal
    Prevent workspace bloat and make artifact handling deterministic and safe.

    ## Deliverables
    - `specs/artifacts/retention.md` enforced
- `xuezh gc --dry-run/--apply` implemented
- Env var overrides for retention windows


    ## Acceptance criteria
    - GC never deletes outside workspace
- Deterministic selection of files to delete
- BDD `gc.feature` passes


    ## Test plan (RGR)
    - Unit: retention selection logic using fake mtimes
- E2E: create temp files and ensure only eligible files are deleted


## Notes
Implemented deterministic GC command with retention config + env overrides, safe workspace deletion,
and added unit + CLI integration tests for dry-run/apply behavior.
