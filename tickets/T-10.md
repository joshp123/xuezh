---
id: T-10
title: Pronunciation assessment v0 + process-voice pipeline (store attempts)
order: 10
depends_on: ["T-09", "T-03"]
blocks: ["T-14"]
implements_commands: ["audio.assess", "audio.process-voice"]
user_requirements: ["UR-05", "UR-07"]
bdd: ["BDD-AUDIO"]
north_stars: ["NS-1", "NS-3"]
status: done
---
    # T-10: Pronunciation assessment v0 + process-voice pipeline (store attempts)

    ## Goal
    Provide an end-to-end voice-note pipeline: convert -> stt -> assess -> feedback audio -> store attempt.

    ## Deliverables
    - `xuezh audio assess --ref-text TEXT --in IN.wav --backend BACKEND_ID`
  - v0 local: simple structured diagnostics (placeholders ok)
  - v1 optional `azure.speech`: behind feature flag + secrets (agenix outside repo)
- `xuezh audio process-voice --in voice.ogg --ref-text TEXT --backend BACKEND_ID`
  - returns artifacts: normalized wav, transcript, assessment, feedback ogg
- Write `pronunciation_attempts` row linking artifacts


    ## Acceptance criteria
    - Single command produces Telegram-ready feedback audio
- Stores attempt with timestamp and summary stats
- If paid mode enabled, respects approval/budget flags


    ## Test plan (RGR)
    - E2E: run process-voice with mocked tool outputs
- Integration: validate envelope and artifact list


## Notes
Implemented local pipeline (convert -> stt -> assess -> tts) with artifacts + attempt storage.
Added assessment unit tests and updated implemented-commands ratchet.
