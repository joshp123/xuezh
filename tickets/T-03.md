---
id: T-03
title: SQLite schema + migrations v0
order: 3
depends_on: ["T-02"]
blocks: ["T-04", "T-05", "T-06", "T-07", "T-11", "T-14"]
implements_commands: ["db.init"]
user_requirements: ["UR-03"]
bdd: ["BDD-REVIEW", "BDD-HSK", "BDD-AUDIO"]
north_stars: ["NS-3", "NS-2"]
status: planned
---
    # T-03: SQLite schema + migrations v0

    ## Goal
    Create SQLite schema that stores primary sources for learning state (no recommendations).

    ## Deliverables
    - Migrations framework (simple `migrations/*.sql` with version table)
- Tables (initial set):
  - users
  - characters
  - words
  - grammar_points
  - user_knowledge (modality split)
  - review_events (append-only)
  - learning_sessions
  - pronunciation_attempts
  - generated_content (cache)
  - error_patterns
  - datasets + dataset_items (HSK/frequency)


    ## Acceptance criteria
- `xuezh db init` creates db and applies migrations
- Migrations are idempotent and track applied versions
- Schema supports storing modality splits and contexts


    ## Test plan (RGR)
    - Integration: initialize DB in temp workspace, check tables exist
- E2E: create user + item rows, record events
