{"id":"xuezh-02s","title":"T-04A: HSK scope \u0026 schema hold point (vocab+grammar, chars optional) — user sign-off required","description":"Source: `tickets/T-04A.md`\n\n```markdown\n---\nid: T-04A\ntitle: HSK scope \u0026 schema hold point (vocab+grammar, chars optional) — user sign-off required\norder: 8\ndepends_on: [\"T-04\", \"T-04B\"]\nblocks: [\"T-07\"]\nnorth_stars: [\"NS-2\", \"NS-3\"]\nuser_requirements: [\"UR-08\", \"UR-09\"]\nbdd: [\"BDD-HSK\"]\nstatus: planned\nrequires_user_review: true\n---\n\n    # T-04A: HSK scope \u0026 schema hold point (vocab+grammar, chars optional) — user sign-off required\n\n    ## Goal\n    Freeze the HSK audit structure based on *real* upstream datasets (not fixtures).\n\n    ## Deliverables\n    - Import real upstream dataset(s) (ivankra/hsk30) into a temp workspace\n- Produce a sample `report.hsk` JSON structure *from actual dataset counts*\n- `specs/hsk-scope.md` reviewed and approved\n- `schemas/report.hsk.schema.json` updated to match scope\n- `docs/cli-contract.md` updated (if needed)\n\n\n    ## Acceptance criteria\n    - Agent produces a sample `report.hsk` JSON structure using the real dataset and requests user approval\n- Once approved, schema/contract/BDD are updated to match and frozen\n\n\n    ## Test plan (RGR)\n    - Contract sync tests pass\n- Schema validation enforces coverage.vocab and coverage.grammar\n\n\n## Notes\nThis ticket is a deliberate stop-the-line gate to avoid implementing the wrong HSK interpretation.\n```\n","notes":"Reopened per CTO: T-04A gate not actually executed (no real dataset import + sample report). Must import real upstream dataset and present report.hsk sample for approval.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-18T19:25:10.689551+01:00","updated_at":"2025-12-19T11:33:45.136542+01:00","external_ref":"tickets/T-04A.md","labels":["order-08","requires-user-review","ticket","ticket-t-04a"],"dependencies":[{"issue_id":"xuezh-02s","depends_on_id":"xuezh-dd5","type":"blocks","created_at":"2025-12-18T19:25:10.691036+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-02s","depends_on_id":"xuezh-uxf","type":"blocks","created_at":"2025-12-18T23:06:47.256269+01:00","created_by":"daemon","metadata":"{}"}]}
{"id":"xuezh-1tz","title":"T-01B: Freeze ID scheme + enforce across schemas/DB/CLI","description":"Source: `tickets/T-01B.md`\n\n```markdown\n---\nid: T-01B\ntitle: Freeze ID scheme + enforce across schemas/DB/CLI\norder: 2\ndepends_on: [\"T-01\"]\nblocks: [\"T-03\", \"T-06\", \"T-07\"]\nnorth_stars: [\"NS-3\", \"NS-2\"]\nuser_requirements: [\"UR-09\", \"UR-03\"]\nbdd: [\"BDD-REVIEW\", \"BDD-HSK\", \"BDD-ZFC\"]\nstatus: planned\nrequires_user_review: false\n---\n\n    # T-01B: Freeze ID scheme + enforce across schemas/DB/CLI\n\n    ## Goal\n    Make IDs deterministic and unambiguous so the tool is safe to automate and test.\n\n    ## Deliverables\n    - `specs/id-scheme.md` treated as authoritative\n- Update schemas to validate ID formats where applicable\n- Update DB schema to store item IDs as TEXT primary keys (or with UNIQUE constraints)\n- Update CLI outputs to use item IDs everywhere (review, reports, events)\n\n\n    ## Acceptance criteria\n    - All item IDs follow regexes in `specs/id-scheme.md`\n- Dataset import uses deterministic ID computation and is idempotent\n- BDD scenarios use valid IDs and remain in sync with contract\n\n\n    ## Test plan (RGR)\n    - Unit: ID generation and normalization tests\n- Contract: schema validation includes ID format constraints\n```\n","notes":"Implemented deterministic ID helpers (src/xuezh/core/ids.py) with unit tests; enforced ID regex patterns in schemas for event.log (event_id/items) and content.cache.put (content_id).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T19:25:10.139112+01:00","updated_at":"2025-12-18T22:49:22.570697+01:00","closed_at":"2025-12-18T22:49:22.570697+01:00","close_reason":"Closed","external_ref":"tickets/T-01B.md","labels":["order-02","ticket","ticket-t-01b"],"dependencies":[{"issue_id":"xuezh-1tz","depends_on_id":"xuezh-g14","type":"blocks","created_at":"2025-12-18T19:25:10.139988+01:00","created_by":"daemon","metadata":"{}"}]}
{"id":"xuezh-1u6","title":"Fix devenv so  evaluates and check.sh can run","description":"Goal\n- Make `devenv shell` work on a fresh clone and provide the required toolchain for this repo.\n\nCurrent blocker\n- `devenv shell` fails because `languages.nodejs` option does not exist in devenv 1.11.x.\n\nScope\n- Update `devenv.nix` to use supported language options (or remove Node entirely if unused).\n- Ensure required runtime tools are available (git, jq, ffmpeg, yt-dlp, gh).\n- Ensure python venv support is intact (Python 3.11).\n\nNon-goals\n- No feature implementation; only dev environment correctness.","acceptance_criteria":"Acceptance\n- `devenv shell --help` works (sanity) and `devenv shell bash -lc \"python -V\"` succeeds.\n- `devenv shell bash -lc \"python -m pip install -e \".[dev]\"\"` succeeds.\n- `devenv shell bash -lc \"./scripts/check.sh\"` succeeds (after step 2 rename is merged).\n\nNotes\n- Keep config minimal; add tools only when required by scripts/tests.","status":"in_progress","priority":0,"issue_type":"chore","created_at":"2025-12-18T16:59:20.753235+01:00","updated_at":"2025-12-18T17:12:18.99295+01:00","dependencies":[{"issue_id":"xuezh-1u6","depends_on_id":"xuezh-tv8","type":"blocks","created_at":"2025-12-18T16:59:20.756295+01:00","created_by":"daemon","metadata":"{}"}]}
{"id":"xuezh-2hl","title":"T-07: Reports v1: HSK audit + mastery facts + progress metrics","description":"Source: `tickets/T-07.md`\n\n```markdown\n---\nid: T-07\ntitle: Reports v1: HSK audit + mastery facts + progress metrics\norder: 7\ndepends_on: [\"T-06\"]\nblocks: [\"T-14\"]\nimplements_commands: [\"report.due\", \"report.hsk\", \"report.mastery\"]\nuser_requirements: [\"UR-07\", \"UR-08\", \"UR-09\"]\nbdd: [\"BDD-HSK\", \"BDD-ZFC\"]\nnorth_stars: [\"NS-2\", \"NS-3\"]\nstatus: planned\n---\n    # T-07: Reports v1: HSK audit + mastery facts + progress metrics\n\n    ## Goal\n    Provide bounded, auditable reports used by the model for decisions.\n\n    ## Deliverables\n    - `xuezh report hsk --level L --window W --max-items N`\n  - coverage, recency distribution, bounded evidence rows\n- `xuezh report mastery --item-type character|word|grammar --window W --max-items N`\n  - facts: last_seen, times_seen, success rates, due_at, pronunciation stats\n  - Progress facts are surfaced via existing reports plus `snapshot` (see `tickets/T-05.md`) rather than a dedicated progress-report command in v1.\n\n\n    ## Acceptance criteria\n    - Reports are bounded; spill to artifact when needed\n- Evidence rows have stable ordering\n- Reports contain facts only (no recommendations)\n\n\n    ## Test plan (RGR)\n    - Integration: run each report against fixture DB and validate schema\n- Unit: forbidden keys checks (BDD-ZFC)\n```\n","notes":"Implemented report.hsk and report.mastery (bounded, deterministic). Added integration tests and updated implemented-commands list.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T19:25:11.125774+01:00","updated_at":"2025-12-18T23:55:01.277071+01:00","closed_at":"2025-12-18T23:55:01.277071+01:00","close_reason":"Closed","external_ref":"tickets/T-07.md","labels":["order-12","ticket","ticket-t-07"],"dependencies":[{"issue_id":"xuezh-2hl","depends_on_id":"xuezh-n3w","type":"blocks","created_at":"2025-12-18T19:25:11.127115+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-2hl","depends_on_id":"xuezh-g14","type":"blocks","created_at":"2025-12-18T19:26:35.407463+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-2hl","depends_on_id":"xuezh-1tz","type":"blocks","created_at":"2025-12-18T19:26:35.995758+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-2hl","depends_on_id":"xuezh-opc","type":"blocks","created_at":"2025-12-18T19:26:36.868186+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-2hl","depends_on_id":"xuezh-dd5","type":"blocks","created_at":"2025-12-18T19:26:37.154036+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-2hl","depends_on_id":"xuezh-02s","type":"blocks","created_at":"2025-12-18T19:26:37.345968+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-2hl","depends_on_id":"xuezh-3n6","type":"blocks","created_at":"2025-12-18T19:26:37.927331+01:00","created_by":"daemon","metadata":"{}"}]}
{"id":"xuezh-3n6","title":"T-06B: Event logging primitives (exposures) + snapshot integration","description":"Source: `tickets/T-06B.md`\n\n```markdown\n---\nid: T-06B\ntitle: Event logging primitives (exposures) + snapshot integration\norder: 11\ndepends_on: [\"T-06\"]\nblocks: [\"T-07\", \"T-14\"]\nimplements_commands: [\"event.list\", \"event.log\"]\nnorth_stars: [\"NS-1\", \"NS-2\", \"NS-3\"]\nuser_requirements: [\"UR-02\", \"UR-03\", \"UR-09\"]\nbdd: [\"BDD-EVENTS\", \"BDD-ZFC\"]\nstatus: planned\nrequires_user_review: false\n---\n\n    # T-06B: Event logging primitives (exposures) + snapshot integration\n\n    ## Goal\n    Record primary-source exposure events so the model can plan i+1 and recency-aware sessions.\n\n    ## Deliverables\n    - SQLite `events` table (append-only)\n- CLI:\n  - `xuezh event log ...`\n  - `xuezh event list ...`\n- Snapshot includes bounded recent events + exposure counts by modality\n\n\n    ## Acceptance criteria\n    - Events are facts; no scoring or recommendations\n- `event list` ordering is deterministic (ts + id)\n- BDD `events.feature` passes\n\n\n    ## Test plan (RGR)\n    - Integration: log event then list event\n- Unit: parsing items list / items-file safely\n```\n","notes":"Implemented events table + event log/list commands, items parsing with validation, and snapshot integration for recent events + exposure counts. Added unit/integration tests.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T19:25:11.018016+01:00","updated_at":"2025-12-18T23:50:24.35489+01:00","closed_at":"2025-12-18T23:50:24.35489+01:00","close_reason":"Closed","external_ref":"tickets/T-06B.md","labels":["order-11","ticket","ticket-t-06b"],"dependencies":[{"issue_id":"xuezh-3n6","depends_on_id":"xuezh-n3w","type":"blocks","created_at":"2025-12-18T19:25:11.018858+01:00","created_by":"daemon","metadata":"{}"}]}
{"id":"xuezh-46v","title":"Pre-implementation: scaffold policy hardening","description":"Prep work to reduce drift, ambiguity, and agent foot-guns before converting `tickets/` into Beads and starting core implementation.","acceptance_criteria":"- P-01..P-06 issues exist as children of this epic.\n- Each P-0x issue is blocked by the previous one (linear order).","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-18T18:30:05.063873+01:00","updated_at":"2025-12-18T18:48:27.088513+01:00","closed_at":"2025-12-18T18:48:27.088513+01:00","close_reason":"All P-01..P-06 pre-implementation tickets completed.","labels":["pre-implementation","scaffold"]}
{"id":"xuezh-4h6","title":"T-12: Test fixtures + golden traces for CLI (integration + e2e)","description":"Source: `tickets/T-12.md`\n\n```markdown\n---\nid: T-12\ntitle: Test fixtures + golden traces for CLI (integration + e2e)\norder: 12\ndepends_on: [\"T-07\", \"T-10\", \"T-11\"]\nblocks: [\"T-14\"]\nuser_requirements: [\"UR-09\", \"UR-01\"]\nbdd: [\"BDD-REVIEW\", \"BDD-HSK\", \"BDD-AUDIO\", \"BDD-ZFC\"]\nnorth_stars: [\"NS-3\"]\nstatus: planned\n---\n    # T-12: Test fixtures + golden traces for CLI (integration + e2e)\n\n    ## Goal\n    Add fixtures and golden outputs to enable autonomous regression checks.\n\n    ## Deliverables\n    - `tests/fixtures/`:\n  - minimal HSK dataset files\n  - sample DB seed scripts\n  - small sample audio files (if feasible) or mocked outputs\n- Golden JSON files for:\n  - snapshot\n  - report hsk\n  - review start/grade\n  - audio process-voice\n\n\n    ## Acceptance criteria\n    - `pytest` runs end-to-end flows deterministically\n- Golden files updated intentionally when schema changes\n\n\n    ## Test plan (RGR)\n    - E2E: run full flow and compare to golden outputs\n```\n","notes":"Added golden fixtures + e2e golden trace test, seed SQL fixture, and golden outputs for snapshot/report/review/audio process-voice. check.sh green.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T19:25:11.666311+01:00","updated_at":"2025-12-19T00:27:56.477668+01:00","closed_at":"2025-12-19T00:27:56.477668+01:00","close_reason":"Closed","external_ref":"tickets/T-12.md","labels":["order-17","ticket","ticket-t-12"],"dependencies":[{"issue_id":"xuezh-4h6","depends_on_id":"xuezh-2hl","type":"blocks","created_at":"2025-12-18T19:25:11.67656+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-4h6","depends_on_id":"xuezh-9tt","type":"blocks","created_at":"2025-12-18T19:25:11.677587+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-4h6","depends_on_id":"xuezh-72q","type":"blocks","created_at":"2025-12-18T19:25:11.678035+01:00","created_by":"daemon","metadata":"{}"}]}
{"id":"xuezh-4tb","title":"T-00: Project scaffolding + devenv + Python package skeleton","description":"Source: `tickets/T-00.md`\n\n```markdown\n---\nid: T-00\ntitle: Project scaffolding + devenv + Python package skeleton\norder: 0\ndepends_on: []\nblocks: [\"T-01\", \"T-02\", \"T-03\"]\nimplements_commands: [\"version\"]\nuser_requirements: [\"UR-09\"]\nbdd: [\"BDD-ZFC\"]\nnorth_stars: [\"NS-3\"]\nstatus: planned\n---\n    # T-00: Project scaffolding + devenv + Python package skeleton\n\n    ## Goal\n    Create a repo skeleton that forces use of devenv and supports RGR implementation.\n\n    ## Deliverables\n    - `devenv.nix` baseline with required system tools\n- `pyproject.toml` with CLI entrypoint\n- minimal `src/xuezh/` structure\n- `agents.md`, `README.md`, base docs\n\n\n    ## Acceptance criteria\n    - `devenv shell` works\n- `pip install -e .[dev]` works inside devenv\n- `xuezh version --json` prints a valid JSON envelope\n- `pytest` runs (may have minimal smoke tests only)\n\n\n    ## Test plan (RGR)\n    - Unit: validate envelope helper functions\n- Integration: run `xuezh version --json` in subprocess and parse JSON\n\n\n## Notes\nThis ticket is already mostly scaffolded in this bundle; agent should verify and adjust.\n```\n","notes":"Completed T-00 verification in devenv: pip install -e .[dev], xuezh version --json, ./scripts/check.sh (ruff+mypy+pytest).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T19:25:09.911634+01:00","updated_at":"2025-12-18T22:42:52.386694+01:00","closed_at":"2025-12-18T22:42:52.386694+01:00","close_reason":"Closed","external_ref":"tickets/T-00.md","labels":["order-00","ticket","ticket-t-00"]}
{"id":"xuezh-58o","title":"T-05: Snapshot command v1 (bounded context pack for planning)","description":"Source: `tickets/T-05.md`\n\n```markdown\n---\nid: T-05\ntitle: Snapshot command v1 (bounded context pack for planning)\norder: 5\ndepends_on: [\"T-04\"]\nblocks: [\"T-10\", \"T-11\", \"T-14\"]\nimplements_commands: [\"snapshot\"]\nuser_requirements: [\"UR-01\", \"UR-03\", \"UR-08\", \"UR-09\"]\nbdd: [\"BDD-ZFC\", \"BDD-REVIEW\", \"BDD-HSK\"]\nnorth_stars: [\"NS-1\", \"NS-2\", \"NS-3\"]\nstatus: planned\n---\n    # T-05: Snapshot command v1 (bounded context pack for planning)\n\n    ## Goal\n    Produce a bounded JSON snapshot used by the model to make lesson plans.\n\n    ## Deliverables\n    - `xuezh snapshot --window 30d --due-limit N --evidence-limit M --max-bytes K`\n- Snapshot includes facts only:\n  - due items list (deterministic order)\n  - upcoming due counts by day\n  - HSK coverage summary\n  - recent pronunciation trend summary (if present)\n  - recent events pointer (artifact path to ndjson)\n\n\n    ## Acceptance criteria\n    - Snapshot output is deterministic for same DB state\n- Snapshot never contains recommendation fields\n- Output is bounded (spills to artifact if too large)\n\n\n    ## Test plan (RGR)\n    - E2E: create DB state and snapshot; validate keys and determinism\n- Integration: enforce forbidden keys absent (BDD-ZFC)\n```\n","notes":"Implemented snapshot command with bounded output, deterministic behavior (fixed clock), HSK summary counts from latest datasets, and spill artifact when oversized. Added integration test.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T19:25:10.798687+01:00","updated_at":"2025-12-18T23:41:44.070534+01:00","closed_at":"2025-12-18T23:41:44.070534+01:00","close_reason":"Closed","external_ref":"tickets/T-05.md","labels":["order-09","ticket","ticket-t-05"],"dependencies":[{"issue_id":"xuezh-58o","depends_on_id":"xuezh-dd5","type":"blocks","created_at":"2025-12-18T19:25:10.799709+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-58o","depends_on_id":"xuezh-g14","type":"blocks","created_at":"2025-12-18T19:26:35.217141+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-58o","depends_on_id":"xuezh-l3s","type":"blocks","created_at":"2025-12-18T19:26:36.189817+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-58o","depends_on_id":"xuezh-opc","type":"blocks","created_at":"2025-12-18T19:26:36.671431+01:00","created_by":"daemon","metadata":"{}"}]}
{"id":"xuezh-670","title":"P-01: Clarify doc authority + label reference docs","description":"Goal\n- Prevent future agents from treating background/reference docs as requirements.\n\nScope\n- Add a short authority doc (e.g. `docs/README.md`) defining which artifacts are authoritative (contract/specs/schemas/BDD/tickets) vs background.\n- Update `README.md` to point to the authority doc.\n- Add a loud header to `docs/reference/*` stating it is NOT a spec / not authoritative.\n\nNon-goals\n- No contract or CLI behavior changes.","acceptance_criteria":"- `README.md` links to the authority doc.\n- Authority doc clearly states the hierarchy: `docs/cli-contract.md` + `specs/cli/contract.json` + `schemas/` + `specs/bdd/` are authoritative.\n- `docs/reference/oracle-mega-prompt.md` contains an explicit NOT-A-SPEC banner at the top.\n- `./scripts/check.sh` passes.","status":"closed","priority":1,"issue_type":"chore","created_at":"2025-12-18T18:30:14.30177+01:00","updated_at":"2025-12-18T18:39:25.929681+01:00","closed_at":"2025-12-18T18:39:25.929681+01:00","close_reason":"Added docs authority map and marked reference docs as non-authoritative; check.sh passes.","labels":["pre-implementation"],"dependencies":[{"issue_id":"xuezh-670","depends_on_id":"xuezh-46v","type":"parent-child","created_at":"2025-12-18T18:31:33.204852+01:00","created_by":"daemon","metadata":"{}"}]}
{"id":"xuezh-72q","title":"T-11: Content cache v1 (store/retrieve generated stories/dialogues/exercises)","description":"Source: `tickets/T-11.md`\n\n```markdown\n---\nid: T-11\ntitle: Content cache v1 (store/retrieve generated stories/dialogues/exercises)\norder: 11\ndepends_on: [\"T-05\", \"T-03\"]\nblocks: [\"T-14\"]\nimplements_commands: [\"content.cache.get\", \"content.cache.put\"]\nuser_requirements: [\"UR-06\", \"UR-03\"]\nbdd: [\"BDD-ZFC\"]\nnorth_stars: [\"NS-1\", \"NS-3\"]\nstatus: planned\n---\n    # T-11: Content cache v1 (store/retrieve generated stories/dialogues/exercises)\n\n    ## Goal\n    Cache model-generated content as primary-source artifacts; backend remains non-judgmental.\n\n    ## Deliverables\n    - `xuezh content cache put --type story|dialogue|exercise --key HASH --in FILE`\n- `xuezh content cache get --type ... --key HASH`\n- Store metadata in `generated_content` table\n\n\n    ## Acceptance criteria\n    - Cache is deterministic and idempotent per key\n- No quality scoring in backend (ZFC)\n\n\n    ## Test plan (RGR)\n    - Integration: put/get returns same content\n- Unit: path safety\n```\n","notes":"Implemented content cache put/get with deterministic storage + idempotent keys, added integration and unit tests, updated implemented-commands ratchet. check.sh green.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T19:25:11.556581+01:00","updated_at":"2025-12-19T00:21:08.184363+01:00","closed_at":"2025-12-19T00:21:08.184363+01:00","close_reason":"Closed","external_ref":"tickets/T-11.md","labels":["order-16","ticket","ticket-t-11"],"dependencies":[{"issue_id":"xuezh-72q","depends_on_id":"xuezh-58o","type":"blocks","created_at":"2025-12-18T19:25:11.55754+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-72q","depends_on_id":"xuezh-opc","type":"blocks","created_at":"2025-12-18T19:25:11.558073+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-72q","depends_on_id":"xuezh-l3s","type":"blocks","created_at":"2025-12-18T19:26:36.380529+01:00","created_by":"daemon","metadata":"{}"}]}
{"id":"xuezh-8t8","title":"T-09: STT wrapper v1: whisper transcription (bounded JSON)","description":"Source: `tickets/T-09.md`\n\n```markdown\n---\nid: T-09\ntitle: STT wrapper v1: whisper transcription (bounded JSON)\norder: 9\ndepends_on: [\"T-08\"]\nblocks: [\"T-10\"]\nimplements_commands: [\"audio.stt\"]\nuser_requirements: [\"UR-05\"]\nbdd: [\"BDD-AUDIO\"]\nnorth_stars: [\"NS-1\", \"NS-3\"]\nstatus: planned\n---\n    # T-09: STT wrapper v1: whisper transcription (bounded JSON)\n\n    ## Goal\n    Expose Whisper transcription as a CLI command with stable JSON output.\n\n    ## Deliverables\n    - `xuezh audio stt --in IN.wav --backend whisper --json`\n- Store transcript artifact and link in output\n\n\n    ## Acceptance criteria\n    - Produces transcript JSON with text + timestamps if available\n- Output bounded; spills large outputs to artifact file\n\n\n    ## Test plan (RGR)\n    - Integration: run on small fixture wav or mock whisper output\n```\n","notes":"Implemented audio.stt wrapper (whisper CLI), transcript artifact with bounded spill, new STT command builder test, added openai-whisper dependency and updated implemented-commands ratchet. check.sh green.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T19:25:11.341928+01:00","updated_at":"2025-12-19T00:11:45.928968+01:00","closed_at":"2025-12-19T00:11:45.928968+01:00","close_reason":"Closed","external_ref":"tickets/T-09.md","labels":["order-14","ticket","ticket-t-09"],"dependencies":[{"issue_id":"xuezh-8t8","depends_on_id":"xuezh-vqs","type":"blocks","created_at":"2025-12-18T19:25:11.342896+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-8t8","depends_on_id":"xuezh-g14","type":"blocks","created_at":"2025-12-18T19:26:35.603338+01:00","created_by":"daemon","metadata":"{}"}]}
{"id":"xuezh-93s","title":"Add whisper tool check to doctor output","description":"Problem: local audio backend depends on whisper, but `xuezh doctor` does not validate it, so users can get a clean doctor report and then fail at runtime.\n\nGoal: include whisper availability in doctor checks.\n\nOut of scope: changing backend behavior or installation flow.","acceptance_criteria":"1) `xuezh doctor` reports a `tool.whisper` check alongside existing tool checks.\n2) `./scripts/check.sh` still passes.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-19T22:06:28.254719+01:00","updated_at":"2025-12-19T22:06:28.254719+01:00"}
{"id":"xuezh-9tt","title":"T-10: Pronunciation assessment v0 + process-voice pipeline (store attempts)","description":"Source: `tickets/T-10.md`\n\n```markdown\n---\nid: T-10\ntitle: Pronunciation assessment v0 + process-voice pipeline (store attempts)\norder: 10\ndepends_on: [\"T-09\", \"T-03\"]\nblocks: [\"T-14\"]\nimplements_commands: [\"audio.assess\", \"audio.process-voice\"]\nuser_requirements: [\"UR-05\", \"UR-07\"]\nbdd: [\"BDD-AUDIO\"]\nnorth_stars: [\"NS-1\", \"NS-3\"]\nstatus: planned\n---\n    # T-10: Pronunciation assessment v0 + process-voice pipeline (store attempts)\n\n    ## Goal\n    Provide an end-to-end voice-note pipeline: convert -\u003e stt -\u003e assess -\u003e feedback audio -\u003e store attempt.\n\n    ## Deliverables\n    - `xuezh audio assess --ref-text TEXT --in IN.wav --backend BACKEND_ID`\n  - v0 local: simple structured diagnostics (placeholders ok)\n  - v1 optional `azure.speech`: behind feature flag + secrets (agenix outside repo)\n- `xuezh audio process-voice --in voice.ogg --ref-text TEXT --backend BACKEND_ID`\n  - returns artifacts: normalized wav, transcript, assessment, feedback ogg\n- Write `pronunciation_attempts` row linking artifacts\n\n\n    ## Acceptance criteria\n    - Single command produces Telegram-ready feedback audio\n- Stores attempt with timestamp and summary stats\n- If paid mode enabled, respects approval/budget flags\n\n\n    ## Test plan (RGR)\n    - E2E: run process-voice with mocked tool outputs\n- Integration: validate envelope and artifact list\n```\n","notes":"Implemented audio.assess + audio.process-voice pipeline (convert/stt/tts), assessment artifacts, pronunciation_attempts storage, and assessment unit tests. check.sh green.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T19:25:11.448844+01:00","updated_at":"2025-12-19T00:16:37.281889+01:00","closed_at":"2025-12-19T00:16:37.281889+01:00","close_reason":"Closed","external_ref":"tickets/T-10.md","labels":["order-15","ticket","ticket-t-10"],"dependencies":[{"issue_id":"xuezh-9tt","depends_on_id":"xuezh-8t8","type":"blocks","created_at":"2025-12-18T19:25:11.449669+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-9tt","depends_on_id":"xuezh-opc","type":"blocks","created_at":"2025-12-18T19:25:11.450162+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-9tt","depends_on_id":"xuezh-g14","type":"blocks","created_at":"2025-12-18T19:26:35.698103+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-9tt","depends_on_id":"xuezh-58o","type":"blocks","created_at":"2025-12-18T19:26:37.439123+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-9tt","depends_on_id":"xuezh-vqs","type":"blocks","created_at":"2025-12-18T19:26:38.217159+01:00","created_by":"daemon","metadata":"{}"}]}
{"id":"xuezh-dd5","title":"T-04: Dataset import framework (HSK vocab/chars/grammar + frequency lists)","description":"Source: `tickets/T-04.md`\n\n```markdown\n---\nid: T-04\ntitle: Dataset import framework (HSK vocab/chars/grammar + frequency lists)\norder: 4\ndepends_on: [\"T-03\"]\nblocks: [\"T-07\", \"T-05\"]\nimplements_commands: [\"dataset.import\"]\nuser_requirements: [\"UR-08\", \"UR-03\"]\nbdd: [\"BDD-HSK\"]\nnorth_stars: [\"NS-2\", \"NS-3\"]\nstatus: planned\n---\n    # T-04: Dataset import framework (HSK vocab/chars/grammar + frequency lists)\n\n    ## Goal\n    Import external datasets into SQLite for HSK alignment audits.\n\n    ## Deliverables\n    - `xuezh dataset import --type \u003chsk_vocab|hsk_chars|hsk_grammar|frequency\u003e --path FILE`\n- Store dataset version metadata and items\n- Provide deterministic ordering (dataset order or frequency_rank)\n- Include small fixture datasets under `tests/fixtures/` for tests\n\n\n    ## Acceptance criteria\n    - Import is deterministic and idempotent (same file/version doesn't duplicate)\n- Report can join items to HSK level once imported\n\n\n    ## Test plan (RGR)\n    - E2E: import fixture dataset then query counts\n- Integration: validate output envelope and schema\n\n\n## Reference\n- See `specs/datasets-format.md` for accepted import file formats.\n```\n","notes":"Implemented dataset.import with deterministic IDs, idempotent inserts, and fixture import tests; added dataset.import to implemented-commands.json.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T19:25:10.582786+01:00","updated_at":"2025-12-18T23:01:21.811931+01:00","closed_at":"2025-12-18T23:01:21.811931+01:00","close_reason":"Closed","external_ref":"tickets/T-04.md","labels":["order-06","ticket","ticket-t-04"],"dependencies":[{"issue_id":"xuezh-dd5","depends_on_id":"xuezh-opc","type":"blocks","created_at":"2025-12-18T19:25:10.583659+01:00","created_by":"daemon","metadata":"{}"}]}
{"id":"xuezh-dpn","title":"P-04: Typed errors policy + exit-code policy (minimal, extensible)","description":"Goal\n- Define and enforce a minimal policy for typed errors and exit codes without inventing a large upfront enum.\n\nContext\n- Error envelope shape exists, but `error.type` semantics and process/exit codes are not yet frozen.\n\nScope\n- Add/extend spec text describing:\n  - what `error.type` is (stable string used for branching)\n  - when to introduce a new type (only when needed)\n  - requirement to document/register new types when introduced\n- Decide and implement exit-code policy:\n  - `ok: true` =\u003e exit 0\n  - `ok: false` =\u003e non-zero exit code\n  - still always print a JSON envelope when possible\n- Add a small registry of known error types (starts small; grows only when needed) and a test that enforces: if code emits a type, it must be registered.\n\nNon-goals\n- No broad refactors; do not implement missing commands.","acceptance_criteria":"- Spec documents typed error policy and exit-code policy.\n- CLI uses non-zero exit code for `ok:false` while still printing JSON envelopes.\n- New test fails if an unregistered `error.type` is emitted.\n- `./scripts/check.sh` passes.","status":"closed","priority":1,"issue_type":"chore","created_at":"2025-12-18T18:30:40.020394+01:00","updated_at":"2025-12-18T18:45:52.449597+01:00","closed_at":"2025-12-18T18:45:52.449597+01:00","close_reason":"Added typed error policy + registry, enforced known error types, and made CLI exit non-zero on ok:false while still emitting JSON; check.sh passes.","dependencies":[{"issue_id":"xuezh-dpn","depends_on_id":"xuezh-sbx","type":"blocks","created_at":"2025-12-18T18:31:16.769359+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-dpn","depends_on_id":"xuezh-46v","type":"parent-child","created_at":"2025-12-18T18:31:46.508391+01:00","created_by":"daemon","metadata":"{}"}]}
{"id":"xuezh-ef8","title":"T-02B: Artifact retention policy + deterministic GC command","description":"Source: `tickets/T-02B.md`\n\n```markdown\n---\nid: T-02B\ntitle: Artifact retention policy + deterministic GC command\norder: 4\ndepends_on: [\"T-02\"]\nblocks: [\"T-14\"]\nimplements_commands: [\"gc\"]\nnorth_stars: [\"NS-3\", \"NS-2\"]\nuser_requirements: [\"UR-09\"]\nbdd: [\"BDD-GC\", \"BDD-ZFC\"]\nstatus: planned\nrequires_user_review: false\n---\n\n    # T-02B: Artifact retention policy + deterministic GC command\n\n    ## Goal\n    Prevent workspace bloat and make artifact handling deterministic and safe.\n\n    ## Deliverables\n    - `specs/artifacts/retention.md` enforced\n- `xuezh gc --dry-run/--apply` implemented\n- Env var overrides for retention windows\n\n\n    ## Acceptance criteria\n    - GC never deletes outside workspace\n- Deterministic selection of files to delete\n- BDD `gc.feature` passes\n\n\n    ## Test plan (RGR)\n    - Unit: retention selection logic using fake mtimes\n- E2E: create temp files and ensure only eligible files are deleted\n```\n","notes":"Implemented GC (dry-run/apply) with deterministic retention selection and env overrides; added unit + integration tests; updated implemented-commands.json to include gc.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T19:25:10.36569+01:00","updated_at":"2025-12-18T22:55:06.734351+01:00","closed_at":"2025-12-18T22:55:06.734351+01:00","close_reason":"Closed","external_ref":"tickets/T-02B.md","labels":["order-04","ticket","ticket-t-02b"],"dependencies":[{"issue_id":"xuezh-ef8","depends_on_id":"xuezh-l3s","type":"blocks","created_at":"2025-12-18T19:25:10.36658+01:00","created_by":"daemon","metadata":"{}"}]}
{"id":"xuezh-emv","title":"T-14: Operational polish: doctor/export/logging + backups","description":"Source: `tickets/T-14.md`\n\n```markdown\n---\nid: T-14\ntitle: Operational polish: doctor/export/logging + backups\norder: 14\ndepends_on: [\"T-12\", \"T-13\"]\nblocks: []\nimplements_commands: [\"doctor\"]\nuser_requirements: [\"UR-01\", \"UR-07\", \"UR-09\"]\nbdd: [\"BDD-ZFC\"]\nnorth_stars: [\"NS-3\", \"NS-2\"]\nstatus: planned\n---\n    # T-14: Operational polish: doctor/export/logging + backups\n\n    ## Goal\n    Make the engine robust for daily use and easy to debug.\n\n    ## Deliverables\n    - `xuezh doctor` prints resolved paths, tool availability, db status\n- `xuezh export` produces weekly export artifacts (json/csv) in workspace\n- Structured logs and event journal pointers\n- Backup command (mechanical) or automatic on db init/close\n\n\n    ## Acceptance criteria\n    - Engine is debuggable without reading code\n- Exports are bounded and stored as artifacts\n\n\n    ## Test plan (RGR)\n    - Integration: `doctor` output envelope\n- E2E: export creates files in workspace\n```\n","notes":"Implemented doctor diagnostics (workspace/db/tool checks). Export/logging/backups deferred since no CLI contract commands exist.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T19:25:11.89416+01:00","updated_at":"2025-12-19T00:39:15.532241+01:00","closed_at":"2025-12-19T00:39:15.532241+01:00","close_reason":"Closed","external_ref":"tickets/T-14.md","labels":["order-19","ticket","ticket-t-14"],"dependencies":[{"issue_id":"xuezh-emv","depends_on_id":"xuezh-4h6","type":"blocks","created_at":"2025-12-18T19:25:11.895237+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-emv","depends_on_id":"xuezh-r8r","type":"blocks","created_at":"2025-12-18T19:25:11.895935+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-emv","depends_on_id":"xuezh-ef8","type":"blocks","created_at":"2025-12-18T19:26:36.477884+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-emv","depends_on_id":"xuezh-opc","type":"blocks","created_at":"2025-12-18T19:26:37.056639+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-emv","depends_on_id":"xuezh-58o","type":"blocks","created_at":"2025-12-18T19:26:37.632374+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-emv","depends_on_id":"xuezh-n3w","type":"blocks","created_at":"2025-12-18T19:26:37.827573+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-emv","depends_on_id":"xuezh-3n6","type":"blocks","created_at":"2025-12-18T19:26:38.021855+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-emv","depends_on_id":"xuezh-2hl","type":"blocks","created_at":"2025-12-18T19:26:38.118397+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-emv","depends_on_id":"xuezh-9tt","type":"blocks","created_at":"2025-12-18T19:26:38.410755+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-emv","depends_on_id":"xuezh-72q","type":"blocks","created_at":"2025-12-18T19:26:38.509605+01:00","created_by":"daemon","metadata":"{}"}]}
{"id":"xuezh-g14","title":"T-01: CLI contract: JSON envelope, typed errors, JSON Schemas, bounded output conventions","description":"Source: `tickets/T-01.md`\n\n```markdown\n---\nid: T-01\ntitle: CLI contract: JSON envelope, typed errors, JSON Schemas, bounded output conventions\norder: 1\ndepends_on: [\"T-00\"]\nblocks: [\"T-05\", \"T-06\", \"T-07\", \"T-08\", \"T-09\", \"T-10\"]\nuser_requirements: [\"UR-09\", \"UR-01\"]\nbdd: [\"BDD-ZFC\"]\nnorth_stars: [\"NS-3\"]\nstatus: planned\n---\n    # T-01: CLI contract: JSON envelope, typed errors, JSON Schemas, bounded output conventions\n\n    ## Goal\n    Define stable public contract for all CLI commands (the tool surface used by the LLM skill).\n\n    ## Deliverables\n    - `schemas/` directory with JSON Schema for:\n  - envelope (ok/err)\n  - snapshot\n  - report_hsk\n  - review_start/grade\n  - audio_process_voice\n- CLI conventions:\n  - `--json` default for all commands (or explicit)\n  - `--limit`, `--max-bytes`\n  - truncation behavior: spill to artifact file if needed\n\n\n    ## Acceptance criteria\n    - Each implemented command output validates against its schema\n- `--max-bytes` enforced for reports/snapshots\n- Errors use typed codes (VALIDATION_ERROR, NOT_FOUND, TOOL_TIMEOUT, POLICY_DENIED, INTERNAL)\n\n\n    ## Test plan (RGR)\n    - Unit: JSON schema validation for envelope\n- Integration: run a stub command and validate envelope keys and error code\n- Unit/Integration: enforce that forbidden recommendation fields never appear (BDD-ZFC)\n```\n","notes":"T-01 verified in scaffold: envelope schemas + command schemas present; CLI flags include --limit/--max-bytes; error types enforced; contract/BDD tests validate envelopes and schemas.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T19:25:10.018386+01:00","updated_at":"2025-12-18T22:46:20.44562+01:00","closed_at":"2025-12-18T22:46:20.44562+01:00","close_reason":"Closed","external_ref":"tickets/T-01.md","labels":["order-01","ticket","ticket-t-01"],"dependencies":[{"issue_id":"xuezh-g14","depends_on_id":"xuezh-4tb","type":"blocks","created_at":"2025-12-18T19:25:10.019209+01:00","created_by":"daemon","metadata":"{}"}]}
{"id":"xuezh-gg6","title":"CI: disk exhaustion during pip install (torch/openai-whisper)","description":"CI packaging/storage strategy (Nix + pip + torch) on GitHub runners; current failure is disk exhaustion. Park for now per CTO: CI not required for POC as long as local full suite passes.","acceptance_criteria":"- Document packaging/CI strategy options (Nix vs plain Python + Docker layers)\n- Choose path when moving beyond POC","notes":"Duplicate of CI packaging strategy; merged into xuezh-y9k.","status":"closed","priority":2,"issue_type":"chore","created_at":"2025-12-19T09:51:14.569777+01:00","updated_at":"2025-12-19T11:33:53.920877+01:00","closed_at":"2025-12-19T11:33:53.92088+01:00"}
{"id":"xuezh-kij","title":"Inline actionable pronunciation payload for audio.process-voice + size guard","description":"**User Story**:\nAs a CLI consumer (LLM/tooling)\nI want `audio.process-voice` to return actionable pronunciation data inline\nSo that feedback can be generated without extra file reads.\n\n**Problem Statement**:\nCurrent `audio.process-voice` only returns `artifacts_index` with paths; transcript/assessment are not inline, forcing extra file reads and token overhead.\n\n**Out of Scope**:\n- No change to backend selection logic\n- Do not inline raw Azure response payload\n- No new CLI flags (size guard is automatic)","design":"**Implementation Approach**:\n- Compute inline payload size for assessment/transcript.\n- If above threshold, inline summary only; keep full detail artifacts; set envelope `truncated=true` + `limits.inline_bytes_max`.\n- Update schema and golden outputs to reflect inline fields.\n\n**Suggested branch**: feature/inline-pronunciation-payload","acceptance_criteria":"1) Given `audio.process-voice`, when it succeeds, then `data.assessment` and `data.transcript` are present inline.\n2) Given large word/phoneme detail, when inline payload exceeds the guard, then only summary fields are inline and full detail remains in artifacts (and envelope `truncated` is true with limits set).\n3) `azure_response` remains artifact-only (not inline).\n4) Schema + contract + golden tests updated accordingly and `./scripts/check.sh` passes.","notes":"Starting implementation now. Will inline assessment+transcript, add size guard with summary spill, update schema/contract/goldens, run ./scripts/check.sh.","status":"in_progress","priority":1,"issue_type":"task","created_at":"2025-12-19T19:11:01.445628+01:00","updated_at":"2025-12-19T19:11:05.020487+01:00"}
{"id":"xuezh-l3s","title":"T-02: Workspace management: paths, backups, artifact store, path safety","description":"Source: `tickets/T-02.md`\n\n```markdown\n---\nid: T-02\ntitle: Workspace management: paths, backups, artifact store, path safety\norder: 2\ndepends_on: [\"T-01\"]\nblocks: [\"T-03\", \"T-05\", \"T-08\", \"T-11\"]\nuser_requirements: [\"UR-03\", \"UR-09\"]\nbdd: [\"BDD-ZFC\"]\nnorth_stars: [\"NS-3\", \"NS-2\"]\nstatus: planned\n---\n    # T-02: Workspace management: paths, backups, artifact store, path safety\n\n    ## Goal\n    Implement workspace directory conventions, artifact storage, and filesystem safety.\n\n    ## Deliverables\n    - Config:\n- `XUEZH_WORKSPACE_DIR`, `XUEZH_DB_PATH`\n- Ensure workspace exists; create subdirs:\n  - `artifacts/`, `cache/`, `exports/`, `backups/`\n- Path traversal prevention for all outputs\n- Backup helper: daily backup file naming (mechanical)\n\n\n    ## Acceptance criteria\n    - Engine never writes outside workspace\n- Artifact paths are validated and normalized\n- Workspace can be pointed to temp dir in tests via env vars\n\n\n    ## Test plan (RGR)\n    - Unit: path traversal tests\n- Integration: `xuezh doctor` (to be added) prints resolved paths\n```\n","notes":"Implemented workspace creation + subdirs, resolve_in_workspace guard, and daily backup path helper; added unit tests for traversal and env overrides.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T19:25:10.252618+01:00","updated_at":"2025-12-18T22:51:11.690619+01:00","closed_at":"2025-12-18T22:51:11.690619+01:00","close_reason":"Closed","external_ref":"tickets/T-02.md","labels":["order-03","ticket","ticket-t-02"],"dependencies":[{"issue_id":"xuezh-l3s","depends_on_id":"xuezh-g14","type":"blocks","created_at":"2025-12-18T19:25:10.25351+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-l3s","depends_on_id":"xuezh-4tb","type":"blocks","created_at":"2025-12-18T19:26:35.025462+01:00","created_by":"daemon","metadata":"{}"}]}
{"id":"xuezh-m2b","title":"Pronunciation assessment backend via Azure Speech (MS)","description":"Implement Microsoft Azure Speech Pronunciation Assessment as optional backend for audio.assess/process-voice. Must be deterministic, auditable, and gated by explicit backend selection + secrets. Prefer GitHub samples where possible and cross-reference docs for parameters.","acceptance_criteria":"- Backend id azure.speech supported in audio.assess and audio.process-voice\\n- Uses Speech SDK pronunciation assessment with deterministic params (locale zh-CN, scoring granularity configured)\\n- Captures raw response JSON artifact + normalized assessment JSON\\n- Enforces free-tier-only usage by surfacing quota errors (no paid fallback)\\n- Handles auth/limit errors with typed error codes\\n- Docs updated with setup + free-tier cap behavior","notes":"Implemented azure.speech backend (Speech SDK), raw+normalized artifacts, env var credentials, quota/auth error mapping; updated docs with free-tier policy. check.sh green.","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-19T00:38:28.057383+01:00","updated_at":"2025-12-19T01:17:03.939765+01:00","closed_at":"2025-12-19T01:17:03.939765+01:00","close_reason":"Closed","external_ref":"tickets/T-15.md"}
{"id":"xuezh-n3w","title":"T-06: SRS primitives v1: review start/grade + due/preview","description":"Source: `tickets/T-06.md`\n\n```markdown\n---\nid: T-06\ntitle: SRS primitives v1: review start/grade + due/preview\norder: 6\ndepends_on: [\"T-05\"]\nblocks: [\"T-07\", \"T-14\"]\nimplements_commands: [\"review.bury\", \"review.grade\", \"review.start\", \"srs.preview\"]\nuser_requirements: [\"UR-04\", \"UR-03\", \"UR-09\"]\nbdd: [\"BDD-REVIEW\", \"BDD-ZFC\"]\nnorth_stars: [\"NS-1\", \"NS-3\"]\nstatus: planned\n---\n    # T-06: SRS primitives v1: review start/grade + due/preview\n\n    ## Goal\n    Implement mechanical review flow with stored outcomes and due dates, without pedagogical recommendations.\n\n    ## Deliverables\n    - `xuezh review start --limit N` returns due items\n- `xuezh review grade --item ITEM --grade 0..5 [--next-due ISO | --rule sm2|leitner]`\n- `xuezh report due --limit N`\n- `xuezh srs preview --days D` (counts by day)\n\n\n    ## Acceptance criteria\n    - Due items ordered deterministically: due_at ASC, item_id ASC\n- Grade records append-only review_event\n- Scheduling is mechanical:\n  - either engine applies rule chosen by model\n  - or model supplies exact next_due override\n- No “what next” output fields\n\n\n    ## Test plan (RGR)\n    - Unit: schedule transform functions\n- E2E: create due item -\u003e start -\u003e grade -\u003e confirm due_at updated\n- Integration: CLI JSON output validates schema\n```\n","notes":"Implemented review.start/grade/bury, report.due, and srs.preview with deterministic scheduling and append-only events. Added migration for due_at, plus unit/integration tests.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T19:25:10.905305+01:00","updated_at":"2025-12-18T23:46:24.291403+01:00","closed_at":"2025-12-18T23:46:24.291403+01:00","close_reason":"Closed","external_ref":"tickets/T-06.md","labels":["order-10","ticket","ticket-t-06"],"dependencies":[{"issue_id":"xuezh-n3w","depends_on_id":"xuezh-58o","type":"blocks","created_at":"2025-12-18T19:25:10.906166+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-n3w","depends_on_id":"xuezh-g14","type":"blocks","created_at":"2025-12-18T19:26:35.311934+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-n3w","depends_on_id":"xuezh-1tz","type":"blocks","created_at":"2025-12-18T19:26:35.896382+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-n3w","depends_on_id":"xuezh-opc","type":"blocks","created_at":"2025-12-18T19:26:36.770123+01:00","created_by":"daemon","metadata":"{}"}]}
{"id":"xuezh-oex","title":"Make audio pipeline spec pluggable with deterministic backends","description":"Goal\\n- Support explicit backend selection for audio commands (no mocks required).\\n\\nScope\\n- Update CLI contract + machine contract to document backend switch (env var + CLI option).\\n- Ensure backend id is echoed in outputs.\\n- Keep defaults (no added flags required for standard usage).\\n\\nNon-goals\\n- Do not add mock/deterministic backends.\\n- Do not change behavior unless backend switch is explicitly used.\\n\\nAcceptance Criteria\\n- docs/cli-contract.md + specs/cli/contract.json define backend selection mechanism.\\n- audio commands honor explicit backend selection.\\n- Contract/BDD sync still passes.","design":"Design notes\n- Prefer explicit configuration over autodetection (avoid heuristics/ZFC violations).\n- Use a single env var (e.g. `XUEZH_AUDIO_BACKEND`) with optional per-command override flag if needed.\n- Keep Azure/pronunciation paid mode gated behind explicit flags + secrets; document clearly.","acceptance_criteria":"Acceptance\n- `docs/cli-contract.md` + `specs/cli/contract.json` specify how to choose an audio backend deterministically.\n- BDD audio scenarios are updated to use the deterministic backend selection mechanism.\n- Contract sync tests still pass (schema/BDD/contract alignment).\n- No new CI requirement for secrets/network for the default backend.","notes":"Implemented deterministic audio backend selection via env vars; added BDD env step, e2e env pin, precedence helper + unit test. Tests: ./scripts/check.sh","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-18T16:59:41.545559+01:00","updated_at":"2025-12-19T14:19:58.468287+01:00","closed_at":"2025-12-19T14:19:58.468287+01:00","close_reason":"Closed","dependencies":[{"issue_id":"xuezh-oex","depends_on_id":"xuezh-tfz","type":"blocks","created_at":"2025-12-18T16:59:41.548123+01:00","created_by":"daemon","metadata":"{}"}]}
{"id":"xuezh-opc","title":"T-03: SQLite schema + migrations v0","description":"Source: `tickets/T-03.md`\n\n```markdown\n---\nid: T-03\ntitle: SQLite schema + migrations v0\norder: 3\ndepends_on: [\"T-02\"]\nblocks: [\"T-04\", \"T-05\", \"T-06\", \"T-07\", \"T-11\", \"T-14\"]\nimplements_commands: [\"db.init\"]\nuser_requirements: [\"UR-03\"]\nbdd: [\"BDD-REVIEW\", \"BDD-HSK\", \"BDD-AUDIO\"]\nnorth_stars: [\"NS-3\", \"NS-2\"]\nstatus: planned\n---\n    # T-03: SQLite schema + migrations v0\n\n    ## Goal\n    Create SQLite schema that stores primary sources for learning state (no recommendations).\n\n    ## Deliverables\n    - Migrations framework (simple `migrations/*.sql` with version table)\n- Tables (initial set):\n  - users\n  - characters\n  - words\n  - grammar_points\n  - user_knowledge (modality split)\n  - review_events (append-only)\n  - learning_sessions\n  - pronunciation_attempts\n  - generated_content (cache)\n  - error_patterns\n  - datasets + dataset_items (HSK/frequency)\n\n\n    ## Acceptance criteria\n- `xuezh db init` creates db and applies migrations\n- Migrations are idempotent and track applied versions\n- Schema supports storing modality splits and contexts\n\n\n    ## Test plan (RGR)\n    - Integration: initialize DB in temp workspace, check tables exist\n- E2E: create user + item rows, record events\n```\n","notes":"Implemented SQLite migrations framework + initial schema, db.init command, and integration test validating tables + inserts. Added db.init to implemented-commands.json.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T19:25:10.473061+01:00","updated_at":"2025-12-18T22:57:43.629871+01:00","closed_at":"2025-12-18T22:57:43.629871+01:00","close_reason":"Closed","external_ref":"tickets/T-03.md","labels":["order-05","ticket","ticket-t-03"],"dependencies":[{"issue_id":"xuezh-opc","depends_on_id":"xuezh-l3s","type":"blocks","created_at":"2025-12-18T19:25:10.473894+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-opc","depends_on_id":"xuezh-4tb","type":"blocks","created_at":"2025-12-18T19:26:35.121096+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-opc","depends_on_id":"xuezh-1tz","type":"blocks","created_at":"2025-12-18T19:26:35.797456+01:00","created_by":"daemon","metadata":"{}"}]}
{"id":"xuezh-pbs","title":"Unify pronunciation into single user-facing voice pipeline","description":"Unify user-facing voice flow into a single command: speak -\u003e transcript + pronunciation feedback. audio.process-voice is the only public entry point for learner speech. audio.assess and audio.stt become internal/private primitives (not documented as user-facing). Model TTS remains separate (edge-tts or future).","acceptance_criteria":"- audio process-voice is the only user-facing voice input command in docs/contract\n- audio assess + audio stt are internal/hidden (not in public contract)\n- process-voice always returns transcript + pronunciation assessment\n- Azure pronunciation backend is default for process-voice\n- BDD/schema/contract updated accordingly","notes":"Azure Speech keys rotated; new key stored in nix-secrets as xuezh-azure-speech-key.age (agenix). Region remains westeurope.","status":"closed","priority":0,"issue_type":"feature","created_at":"2025-12-19T11:24:39.89172+01:00","updated_at":"2025-12-19T14:00:07.51692+01:00","closed_at":"2025-12-19T14:00:07.51692+01:00","close_reason":"Closed"}
{"id":"xuezh-r8r","title":"T-13: Skill refinement + examples aligned to final CLI contract","description":"Source: `tickets/T-13.md`\n\n```markdown\n---\nid: T-13\ntitle: Skill refinement + examples aligned to final CLI contract\norder: 13\ndepends_on: [\"T-07\", \"T-10\"]\nblocks: [\"T-14\"]\nuser_requirements: [\"UR-01\", \"UR-02\", \"UR-09\"]\nbdd: [\"BDD-ZFC\"]\nnorth_stars: [\"NS-1\", \"NS-3\"]\nstatus: planned\n---\n    # T-13: Skill refinement + examples aligned to final CLI contract\n\n    ## Goal\n    Ensure Skill prompt is accurate, concise, and drives the CLI correctly.\n\n    ## Deliverables\n    - Update `skills/chinese-learning-orchestrator/SKILL.md` to match final command flags and schema names\n- Add more examples (review, tone loop, graded story constraints)\n- Ensure frontmatter is valid for Anthropic Skills (name/description only)\n\n\n    ## Acceptance criteria\n    - Skill references only implemented commands\n- Examples are copy/paste-able and produce valid JSON envelopes\n\n\n    ## Test plan (RGR)\n    - Manual: run example commands and validate outputs\n- Integration: optional lint to ensure referenced commands exist\n```\n","notes":"Updated Skill doc to match implemented CLI commands, added copy/paste examples, and clarified local v0 pronunciation assessment behavior.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T19:25:11.78719+01:00","updated_at":"2025-12-19T00:38:49.467095+01:00","closed_at":"2025-12-19T00:38:49.467095+01:00","close_reason":"Closed","external_ref":"tickets/T-13.md","labels":["order-18","ticket","ticket-t-13"],"dependencies":[{"issue_id":"xuezh-r8r","depends_on_id":"xuezh-2hl","type":"blocks","created_at":"2025-12-18T19:25:11.788154+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-r8r","depends_on_id":"xuezh-9tt","type":"blocks","created_at":"2025-12-18T19:25:11.788772+01:00","created_by":"daemon","metadata":"{}"}]}
{"id":"xuezh-rpo","title":"De-duplicate Azure word detail in inline pronunciation payload","description":"Problem: Azure pronunciation data currently includes detailed word/phoneme lists in both `assessment.words` and `transcript.words`, inflating inline payload size and triggering truncation earlier than necessary.\n\nGoal: keep detailed word/phoneme breakdown in one place (assessment or transcript), while preserving full detail in artifacts.\n\nOut of scope: changing scoring or assessment logic.","acceptance_criteria":"1) Inline payload contains detailed word/phoneme data in only one of assessment/transcript.\n2) Artifacts still preserve full detail for audit.\n3) `./scripts/check.sh` passes.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-19T22:06:34.484317+01:00","updated_at":"2025-12-19T22:06:34.484317+01:00"}
{"id":"xuezh-s0r","title":"P-06: Audio CI policy (YOLO real backends)","description":"Goal\n- Keep the scaffold small by testing real audio tooling/backends in CI when those commands are implemented.\n\nScope\n- Document that audio command tests should run against real tools (ffmpeg/edge-tts/whisper/etc.) by default.\n- Note expected constraints:\n  - network may be required (e.g. edge-tts)\n  - tool availability must be provided via devenv + pyproject deps\n- Capture the decision to revisit and add mocks/scheduled workflows only if CI becomes flaky.\n\nNon-goals\n- Do not add mock backends or split CI workflows yet.","acceptance_criteria":"- A short doc note exists (likely in `specs/audio-backends.md` or `specs/test-strategy.md`) describing the YOLO policy.\n- `./scripts/check.sh` passes.","status":"closed","priority":1,"issue_type":"chore","created_at":"2025-12-18T18:30:54.480676+01:00","updated_at":"2025-12-18T18:48:01.318787+01:00","closed_at":"2025-12-18T18:48:01.318787+01:00","close_reason":"Documented YOLO policy to run audio tests against real tools/backends in CI; check.sh passes.","dependencies":[{"issue_id":"xuezh-s0r","depends_on_id":"xuezh-vso","type":"blocks","created_at":"2025-12-18T18:31:23.63257+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-s0r","depends_on_id":"xuezh-46v","type":"parent-child","created_at":"2025-12-18T18:31:54.891907+01:00","created_by":"daemon","metadata":"{}"}]}
{"id":"xuezh-sbx","title":"P-03: Add implemented-command ratchet (no silent NOT_IMPLEMENTED)","description":"Goal\n- Keep CI green early, but prevent agents from claiming work is implemented while commands still return `NOT_IMPLEMENTED`.\n\nApproach (mechanical)\n- Introduce an explicit list of \"implemented\" commands (or tickets) that is empty at the start.\n- Update the BDD harness so `NOT_IMPLEMENTED` is only xfailed when the command is NOT in the implemented list.\n- If a command is in the implemented list and still returns `NOT_IMPLEMENTED`, the test must fail.\n\nScope\n- Add an implementation-state file under `specs/` (format TBD: JSON list of command ids is fine).\n- Update `tests/bdd/steps.py` to consult it.\n- Add a small test that proves the ratchet works (empty list =\u003e green; marking a stub =\u003e red).\n- Document the workflow in `specs/test-strategy.md` (how to mark commands implemented).\n\nNon-goals\n- Do not implement any real CLI commands beyond the current scaffold.","acceptance_criteria":"- With an empty implemented list, `./scripts/check.sh` is green while unimplemented commands xfail.\n- If an unimplemented command is added to the implemented list, CI fails with a clear error.\n- If an implemented command is added to the implemented list, its BDD scenarios run strict (no xfail) and validate schemas.\n- `./scripts/check.sh` passes.","status":"closed","priority":1,"issue_type":"chore","created_at":"2025-12-18T18:30:31.654954+01:00","updated_at":"2025-12-18T18:42:01.142442+01:00","closed_at":"2025-12-18T18:42:01.142442+01:00","close_reason":"Added implemented-command ratchet via specs/implemented-commands.json + BDD harness logic; strict mode supported; check.sh passes.","dependencies":[{"issue_id":"xuezh-sbx","depends_on_id":"xuezh-tgp","type":"blocks","created_at":"2025-12-18T18:31:12.981097+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-sbx","depends_on_id":"xuezh-46v","type":"parent-child","created_at":"2025-12-18T18:31:41.173769+01:00","created_by":"daemon","metadata":"{}"}]}
{"id":"xuezh-tfz","title":"Add CI to run scripts/check.sh on push/PR","description":"Goal\\n- Ensure CI runs ./scripts/check.sh on push/PR using real external services/tools (no mocks).\\n\\nScope\\n- Keep .github/workflows/ci.yml on push + PR.\\n- Use devenv; install project deps.\\n- Allow real audio backends (ffmpeg/edge-tts/whisper) and network use.\\n\\nAcceptance Criteria\\n- CI workflow exists and runs on PRs/pushes to main.\\n- Workflow runs ./scripts/check.sh in a clean runner.\\n- External tools/network usage is allowed; no mock-only requirement.","acceptance_criteria":"Acceptance\n- CI workflow exists and runs on PRs and pushes to main.\n- Workflow runs `./scripts/check.sh` successfully in a clean runner.\n- CI does not require secrets for default test run.\n\nNotes\n- It is OK to skip macOS initially; start with ubuntu-latest unless there is a strong reason.","status":"closed","priority":1,"issue_type":"chore","created_at":"2025-12-18T16:59:30.016481+01:00","updated_at":"2025-12-19T00:52:49.091778+01:00","closed_at":"2025-12-19T00:52:49.091778+01:00","close_reason":"CI workflow exists and runs check.sh with real backends; spec updated to allow external services.","dependencies":[{"issue_id":"xuezh-tfz","depends_on_id":"xuezh-1u6","type":"blocks","created_at":"2025-12-18T16:59:30.019295+01:00","created_by":"daemon","metadata":"{}"}]}
{"id":"xuezh-tgp","title":"P-02: Remove report.progress from tickets (YAGNI)","description":"Goal\n- Remove the stray `xuezh report progress` command mention so the contract remains the single source of truth.\n\nContext\n- `tickets/T-07.md` currently mentions `report progress` but the authoritative contract does not define it.\n\nScope\n- Remove `report progress` from `tickets/T-07.md` deliverables/acceptance.\n- Ensure no other doc/spec/skill references a non-existent `report.progress` command.\n- Keep UR-07 satisfied via existing surfaces (snapshot + reports + events) without adding a new CLI command.\n\nNon-goals\n- Do not add a `report.progress` command to the CLI contract in v1.","acceptance_criteria":"- No remaining references to `report progress` / `report.progress` in repo text.\n- Contract sync tests still pass.\n- `./scripts/check.sh` passes.","status":"closed","priority":1,"issue_type":"chore","created_at":"2025-12-18T18:30:22.737786+01:00","updated_at":"2025-12-18T18:40:21.334997+01:00","closed_at":"2025-12-18T18:40:21.334997+01:00","close_reason":"Removed stray progress-report command mention so contract remains authoritative; check.sh passes.","dependencies":[{"issue_id":"xuezh-tgp","depends_on_id":"xuezh-670","type":"blocks","created_at":"2025-12-18T18:31:10.091754+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-tgp","depends_on_id":"xuezh-46v","type":"parent-child","created_at":"2025-12-18T18:31:36.966803+01:00","created_by":"daemon","metadata":"{}"}]}
{"id":"xuezh-tv8","title":"Rename project/tooling from chlearn -\u003e xuezh","description":"Goal\n- Full rename: Python package, CLI binary, env vars, docs/specs/tests.\n\nScope\n- Rename package `chlearn` -\u003e `xuezh` (src layout, imports, module paths).\n- Rename CLI entrypoint `chlearn` -\u003e `xuezh` (pyproject scripts).\n- Rename env vars: `CHLEARN_*` -\u003e `XUEZH_*` (workspace + db path at minimum).\n- Update default workspace dir path to a new xuezh-specific location.\n- Update all docs/specs/skills/BDD strings that mention the command name.\n\nNon-goals\n- No functional feature implementation beyond keeping current stubs working under the new name.","design":"Implementation notes\n- Prefer a clean break (no alias binary) unless you explicitly decide to keep compatibility.\n- If changing workspace directory default, document the migration implications (this is a new project, so it should be fine).\n- Keep commit mechanical: rename + string updates; avoid unrelated refactors.","acceptance_criteria":"Acceptance\n- `python -m pip install -e .[dev]` installs a runnable `xuezh` CLI.\n- `xuezh version --json` returns a valid OK envelope (schema-valid).\n- All BDD feature files invoke `xuezh ...` (no `chlearn` references).\n- `specs/cli/contract.json` + `docs/cli-contract.md` updated to `xuezh` and still pass contract sync tests.\n- No remaining `chlearn` imports or `CHLEARN_` env var usage in source/tests/docs (except possibly historical notes explicitly called out).\n\nValidation\n- Run `./scripts/check.sh` in devenv.","notes":"Rename changes committed, but validation is blocked until devenv is fixed (see xuezh-1u6).","status":"blocked","priority":1,"issue_type":"chore","created_at":"2025-12-18T16:59:07.51651+01:00","updated_at":"2025-12-18T17:12:12.379489+01:00"}
{"id":"xuezh-uxf","title":"T-04B: Select upstream HSK dataset + provenance (source, version, licensing)","description":"Source: `tickets/T-04B.md`\n\n```markdown\n---\nid: T-04B\ntitle: Select upstream HSK dataset + provenance (source, version, licensing)\norder: 7\ndepends_on: [\"T-04\"]\nblocks: [\"T-04A\", \"T-07\"]\nuser_requirements: [\"UR-08\", \"UR-09\"]\nnorth_stars: [\"NS-2\", \"NS-3\"]\nbdd: [\"BDD-HSK\"]\nstatus: planned\nrequires_user_review: true\n---\n    # T-04B: Select upstream HSK dataset + provenance (source, version, licensing)\n\n    ## Goal\n    Choose the canonical upstream HSK dataset so reports and audits reflect real data and legal provenance.\n\n    ## Deliverables\n    - Decide primary HSK dataset source(s) for vocab/grammar (and chars if included)\n    - Record source URLs, version identifiers, and license terms in `specs/datasets/provenance.md`\n    - Capture any required preprocessing steps (format normalization only)\n    - Provide a small local snapshot under `specs/datasets/` or `tests/fixtures/` (if licensing allows)\n\n    ## Acceptance criteria\n    - User approves the selected dataset source(s) and licensing constraints\n    - Provenance doc updated with version + license\n    - Report planning references only the approved dataset(s)\n\n    ## Test plan (RGR)\n    - Manual: verify provenance doc completeness and source accessibility\n```\n","notes":"Selected ivankra/hsk30 as canonical HSK dataset (vocab+grammar+chars). Updated specs/datasets/provenance.md with selection + default policy + commit pin guidance.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T23:06:47.014867+01:00","updated_at":"2025-12-18T23:19:07.974626+01:00","closed_at":"2025-12-18T23:19:07.974626+01:00","close_reason":"Closed","external_ref":"tickets/T-04B.md","labels":["order-07","requires-user-review","ticket","ticket-t-04b"],"dependencies":[{"issue_id":"xuezh-uxf","depends_on_id":"xuezh-dd5","type":"blocks","created_at":"2025-12-18T23:06:56.078922+01:00","created_by":"daemon","metadata":"{}"}]}
{"id":"xuezh-vqs","title":"T-08: Audio wrappers v1: convert + TTS (Telegram-ready artifacts)","description":"Source: `tickets/T-08.md`\n\n```markdown\n---\nid: T-08\ntitle: Audio wrappers v1: convert + TTS (Telegram-ready artifacts)\norder: 8\ndepends_on: [\"T-02\"]\nblocks: [\"T-10\"]\nimplements_commands: [\"audio.convert\", \"audio.tts\"]\nuser_requirements: [\"UR-05\"]\nbdd: [\"BDD-AUDIO\"]\nnorth_stars: [\"NS-1\", \"NS-3\"]\nstatus: planned\n---\n    # T-08: Audio wrappers v1: convert + TTS (Telegram-ready artifacts)\n\n    ## Goal\n    Implement CLI wrappers around ffmpeg and edge-tts to produce ready-to-send audio files.\n\n    ## Deliverables\n    - `xuezh audio convert --in IN --out OUT --format wav|ogg|mp3 --backend ffmpeg`\n- `xuezh audio tts --text TEXT --voice VOICE --out OUT.ogg --backend edge-tts`\n- Validate tool availability, return typed TOOL_MISSING if absent\n\n\n    ## Acceptance criteria\n    - Converts Telegram voice notes (ogg/opus) to normalized wav (16k mono) deterministically\n- TTS outputs Telegram-friendly ogg/opus\n- Artifacts recorded in workspace store\n\n\n    ## Test plan (RGR)\n    - Integration: mock subprocess calls OR run with real ffmpeg if available\n- Unit: command-building and path safety\n```\n","notes":"Implemented audio.convert/tts wrappers (ffmpeg + edge-tts), added TOOL_MISSING/BACKEND_FAILED/INVALID_ARGUMENT errors, workspace-safe artifacts, and unit tests for command building/mime. Added edge-tts dependency and updated implemented-commands ratchet. check.sh green.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T19:25:11.23128+01:00","updated_at":"2025-12-19T00:06:07.284841+01:00","closed_at":"2025-12-19T00:06:07.284841+01:00","close_reason":"Closed","external_ref":"tickets/T-08.md","labels":["order-13","ticket","ticket-t-08"],"dependencies":[{"issue_id":"xuezh-vqs","depends_on_id":"xuezh-l3s","type":"blocks","created_at":"2025-12-18T19:25:11.232209+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-vqs","depends_on_id":"xuezh-g14","type":"blocks","created_at":"2025-12-18T19:26:35.50402+01:00","created_by":"daemon","metadata":"{}"}]}
{"id":"xuezh-vso","title":"P-05: Time/window semantics + deterministic clock override","description":"Goal\n- Make time-window commands deterministic and testable without debating calendar semantics.\n\nScope\n- Document window parsing semantics used across commands:\n  - `Nd` / `Nh` are rolling durations (e.g. `30d` = now_utc - 30*24h)\n  - all stored timestamps are UTC ISO-8601\n- Add a single clock abstraction in code (e.g. `xuezh.core.clock.now_utc()`), with an env override for tests (e.g. `XUEZH_TEST_NOW_ISO`).\n- Add unit tests proving window parsing and clock override behavior.\n\nNon-goals\n- No feature implementation of snapshot/reports; just shared primitives and docs.","acceptance_criteria":"- Spec documents rolling-duration semantics and UTC requirement.\n- Clock helper exists with test override.\n- Unit tests cover parsing + override.\n- `./scripts/check.sh` passes.","status":"closed","priority":1,"issue_type":"chore","created_at":"2025-12-18T18:30:47.974963+01:00","updated_at":"2025-12-18T18:47:08.001047+01:00","closed_at":"2025-12-18T18:47:08.001047+01:00","close_reason":"Documented rolling-duration semantics and UTC, added clock helper with XUEZH_TEST_NOW_ISO override + unit tests; check.sh passes.","dependencies":[{"issue_id":"xuezh-vso","depends_on_id":"xuezh-dpn","type":"blocks","created_at":"2025-12-18T18:31:20.487628+01:00","created_by":"daemon","metadata":"{}"},{"issue_id":"xuezh-vso","depends_on_id":"xuezh-46v","type":"parent-child","created_at":"2025-12-18T18:31:50.73907+01:00","created_by":"daemon","metadata":"{}"}]}
{"id":"xuezh-y9k","title":"CI packaging strategy for POC vs production","description":"CI packaging/runner strategy for POC vs production. Current failure: GitHub runner disk exhaustion during pip install (torch/openai-whisper) after Nix install. Decide whether to keep Nix in CI or switch to Python-only + Docker layers; POC can proceed with local tests only.","acceptance_criteria":"- Document options: Nix CI vs Python-only CI vs Docker layering\n- Choose approach when CI is required beyond POC\n- Record decision and implications for audio deps","status":"open","priority":2,"issue_type":"chore","created_at":"2025-12-19T11:24:44.574515+01:00","updated_at":"2025-12-19T11:33:50.361616+01:00","dependencies":[{"issue_id":"xuezh-y9k","depends_on_id":"xuezh-gg6","type":"related","created_at":"2025-12-19T11:34:01.468436+01:00","created_by":"daemon","metadata":"{}"}]}
{"id":"xuezh-ylw","title":"Clean up contract/spec/skill drift and tighten lint","description":"Goal\\n- Remove drift between contract/spec/skill and implemented behavior.\\n\\nScope\\n- Align docs/cli-contract.md, specs/cli/contract.json, schemas/, BDD, and Skill examples.\\n- Ensure Skill examples use valid IDs and flags.\\n- Eliminate lint issues that break ./scripts/check.sh.\\n- Ensure docs/README/workspace/env var docs match actual backend selection rules (no mocks).\\n\\nAcceptance Criteria\\n- ./scripts/check.sh passes locally.\\n- No drift between contract docs, schemas, BDD, and Skill references.\\n- Skill examples are copy/paste-able and use valid IDs/flags.\\n\\nDepends on\\n- xuezh-oex (backend selection rules documented).","acceptance_criteria":"Acceptance\n- `./scripts/check.sh` passes locally (in devenv).\n- No drift between `docs/cli-contract.md`, `specs/cli/contract.json`, `schemas/`, `specs/bdd/`, and Skill references.\n- Skill examples are copy/paste-able and use valid IDs/flags.","status":"open","priority":1,"issue_type":"chore","created_at":"2025-12-18T16:59:49.628522+01:00","updated_at":"2025-12-19T00:53:01.723357+01:00","dependencies":[{"issue_id":"xuezh-ylw","depends_on_id":"xuezh-oex","type":"blocks","created_at":"2025-12-18T16:59:49.631665+01:00","created_by":"daemon","metadata":"{}"}]}
