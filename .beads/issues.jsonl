{"id":"xuezh-1u6","title":"Fix devenv so  evaluates and check.sh can run","description":"Goal\n- Make `devenv shell` work on a fresh clone and provide the required toolchain for this repo.\n\nCurrent blocker\n- `devenv shell` fails because `languages.nodejs` option does not exist in devenv 1.11.x.\n\nScope\n- Update `devenv.nix` to use supported language options (or remove Node entirely if unused).\n- Ensure required runtime tools are available (git, jq, ffmpeg, yt-dlp, gh).\n- Ensure python venv support is intact (Python 3.11).\n\nNon-goals\n- No feature implementation; only dev environment correctness.","acceptance_criteria":"Acceptance\n- `devenv shell --help` works (sanity) and `devenv shell bash -lc \"python -V\"` succeeds.\n- `devenv shell bash -lc \"python -m pip install -e \".[dev]\"\"` succeeds.\n- `devenv shell bash -lc \"./scripts/check.sh\"` succeeds (after step 2 rename is merged).\n\nNotes\n- Keep config minimal; add tools only when required by scripts/tests.","status":"in_progress","priority":0,"issue_type":"chore","created_at":"2025-12-18T16:59:20.753235+01:00","updated_at":"2025-12-18T17:12:18.99295+01:00","dependencies":[{"issue_id":"xuezh-1u6","depends_on_id":"xuezh-tv8","type":"blocks","created_at":"2025-12-18T16:59:20.756295+01:00","created_by":"daemon"}]}
{"id":"xuezh-46v","title":"Pre-implementation: scaffold policy hardening","description":"Prep work to reduce drift, ambiguity, and agent foot-guns before converting `tickets/` into Beads and starting core implementation.","acceptance_criteria":"- P-01..P-06 issues exist as children of this epic.\n- Each P-0x issue is blocked by the previous one (linear order).","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-18T18:30:05.063873+01:00","updated_at":"2025-12-18T18:30:05.063873+01:00","labels":["pre-implementation","scaffold"]}
{"id":"xuezh-670","title":"P-01: Clarify doc authority + label reference docs","description":"Goal\n- Prevent future agents from treating background/reference docs as requirements.\n\nScope\n- Add a short authority doc (e.g. `docs/README.md`) defining which artifacts are authoritative (contract/specs/schemas/BDD/tickets) vs background.\n- Update `README.md` to point to the authority doc.\n- Add a loud header to `docs/reference/*` stating it is NOT a spec / not authoritative.\n\nNon-goals\n- No contract or CLI behavior changes.","acceptance_criteria":"- `README.md` links to the authority doc.\n- Authority doc clearly states the hierarchy: `docs/cli-contract.md` + `specs/cli/contract.json` + `schemas/` + `specs/bdd/` are authoritative.\n- `docs/reference/oracle-mega-prompt.md` contains an explicit NOT-A-SPEC banner at the top.\n- `./scripts/check.sh` passes.","status":"closed","priority":1,"issue_type":"chore","created_at":"2025-12-18T18:30:14.30177+01:00","updated_at":"2025-12-18T18:39:25.929681+01:00","closed_at":"2025-12-18T18:39:25.929681+01:00","close_reason":"Added docs authority map and marked reference docs as non-authoritative; check.sh passes.","labels":["pre-implementation"],"dependencies":[{"issue_id":"xuezh-670","depends_on_id":"xuezh-46v","type":"parent-child","created_at":"2025-12-18T18:31:33.204852+01:00","created_by":"daemon"}]}
{"id":"xuezh-dpn","title":"P-04: Typed errors policy + exit-code policy (minimal, extensible)","description":"Goal\n- Define and enforce a minimal policy for typed errors and exit codes without inventing a large upfront enum.\n\nContext\n- Error envelope shape exists, but `error.type` semantics and process/exit codes are not yet frozen.\n\nScope\n- Add/extend spec text describing:\n  - what `error.type` is (stable string used for branching)\n  - when to introduce a new type (only when needed)\n  - requirement to document/register new types when introduced\n- Decide and implement exit-code policy:\n  - `ok: true` =\u003e exit 0\n  - `ok: false` =\u003e non-zero exit code\n  - still always print a JSON envelope when possible\n- Add a small registry of known error types (starts small; grows only when needed) and a test that enforces: if code emits a type, it must be registered.\n\nNon-goals\n- No broad refactors; do not implement missing commands.","acceptance_criteria":"- Spec documents typed error policy and exit-code policy.\n- CLI uses non-zero exit code for `ok:false` while still printing JSON envelopes.\n- New test fails if an unregistered `error.type` is emitted.\n- `./scripts/check.sh` passes.","status":"open","priority":1,"issue_type":"chore","created_at":"2025-12-18T18:30:40.020394+01:00","updated_at":"2025-12-18T18:30:40.020394+01:00","dependencies":[{"issue_id":"xuezh-dpn","depends_on_id":"xuezh-sbx","type":"blocks","created_at":"2025-12-18T18:31:16.769359+01:00","created_by":"daemon"},{"issue_id":"xuezh-dpn","depends_on_id":"xuezh-46v","type":"parent-child","created_at":"2025-12-18T18:31:46.508391+01:00","created_by":"daemon"}]}
{"id":"xuezh-oex","title":"Make audio pipeline spec pluggable with deterministic backends","description":"Goal\n- Treat audio as pluggable backends so tests/CI are deterministic and do not depend on network, paid APIs, or large model downloads.\n\nScope\n- Update CLI contract + machine-readable contract to include backend selection (env var + optional CLI flag).\n- Define a deterministic `mock` backend contract for:\n  - `audio tts`\n  - `audio stt`\n  - `audio assess`\n  - `audio process-voice`\n- Update BDD scenarios to invoke audio commands with the deterministic backend (or set env var) so they are CI-safe once implemented.\n- Update schemas as needed to reflect backend selection/reporting.\n\nNon-goals\n- Do not implement the full audio pipeline yet; this is spec + contract + test-harness work only.","design":"Design notes\n- Prefer explicit configuration over autodetection (avoid heuristics/ZFC violations).\n- Use a single env var (e.g. `XUEZH_AUDIO_BACKEND`) with optional per-command override flag if needed.\n- Keep Azure/pronunciation paid mode gated behind explicit flags + secrets; document clearly.","acceptance_criteria":"Acceptance\n- `docs/cli-contract.md` + `specs/cli/contract.json` specify how to choose an audio backend deterministically.\n- BDD audio scenarios are updated to use the deterministic backend selection mechanism.\n- Contract sync tests still pass (schema/BDD/contract alignment).\n- No new CI requirement for secrets/network for the default backend.","status":"open","priority":1,"issue_type":"feature","created_at":"2025-12-18T16:59:41.545559+01:00","updated_at":"2025-12-18T16:59:41.545559+01:00","dependencies":[{"issue_id":"xuezh-oex","depends_on_id":"xuezh-tfz","type":"blocks","created_at":"2025-12-18T16:59:41.548123+01:00","created_by":"daemon"}]}
{"id":"xuezh-s0r","title":"P-06: Audio CI policy (YOLO real backends)","description":"Goal\n- Keep the scaffold small by testing real audio tooling/backends in CI when those commands are implemented.\n\nScope\n- Document that audio command tests should run against real tools (ffmpeg/edge-tts/whisper/etc.) by default.\n- Note expected constraints:\n  - network may be required (e.g. edge-tts)\n  - tool availability must be provided via devenv + pyproject deps\n- Capture the decision to revisit and add mocks/scheduled workflows only if CI becomes flaky.\n\nNon-goals\n- Do not add mock backends or split CI workflows yet.","acceptance_criteria":"- A short doc note exists (likely in `specs/audio-backends.md` or `specs/test-strategy.md`) describing the YOLO policy.\n- `./scripts/check.sh` passes.","status":"open","priority":1,"issue_type":"chore","created_at":"2025-12-18T18:30:54.480676+01:00","updated_at":"2025-12-18T18:30:54.480676+01:00","dependencies":[{"issue_id":"xuezh-s0r","depends_on_id":"xuezh-vso","type":"blocks","created_at":"2025-12-18T18:31:23.63257+01:00","created_by":"daemon"},{"issue_id":"xuezh-s0r","depends_on_id":"xuezh-46v","type":"parent-child","created_at":"2025-12-18T18:31:54.891907+01:00","created_by":"daemon"}]}
{"id":"xuezh-sbx","title":"P-03: Add implemented-command ratchet (no silent NOT_IMPLEMENTED)","description":"Goal\n- Keep CI green early, but prevent agents from claiming work is implemented while commands still return `NOT_IMPLEMENTED`.\n\nApproach (mechanical)\n- Introduce an explicit list of \"implemented\" commands (or tickets) that is empty at the start.\n- Update the BDD harness so `NOT_IMPLEMENTED` is only xfailed when the command is NOT in the implemented list.\n- If a command is in the implemented list and still returns `NOT_IMPLEMENTED`, the test must fail.\n\nScope\n- Add an implementation-state file under `specs/` (format TBD: JSON list of command ids is fine).\n- Update `tests/bdd/steps.py` to consult it.\n- Add a small test that proves the ratchet works (empty list =\u003e green; marking a stub =\u003e red).\n- Document the workflow in `specs/test-strategy.md` (how to mark commands implemented).\n\nNon-goals\n- Do not implement any real CLI commands beyond the current scaffold.","acceptance_criteria":"- With an empty implemented list, `./scripts/check.sh` is green while unimplemented commands xfail.\n- If an unimplemented command is added to the implemented list, CI fails with a clear error.\n- If an implemented command is added to the implemented list, its BDD scenarios run strict (no xfail) and validate schemas.\n- `./scripts/check.sh` passes.","status":"open","priority":1,"issue_type":"chore","created_at":"2025-12-18T18:30:31.654954+01:00","updated_at":"2025-12-18T18:30:31.654954+01:00","dependencies":[{"issue_id":"xuezh-sbx","depends_on_id":"xuezh-tgp","type":"blocks","created_at":"2025-12-18T18:31:12.981097+01:00","created_by":"daemon"},{"issue_id":"xuezh-sbx","depends_on_id":"xuezh-46v","type":"parent-child","created_at":"2025-12-18T18:31:41.173769+01:00","created_by":"daemon"}]}
{"id":"xuezh-tfz","title":"Add CI to run scripts/check.sh on push/PR","description":"Goal\n- Add GitHub Actions CI so contract rails are enforced remotely.\n\nScope\n- Add `.github/workflows/ci.yml` that runs on push + PR.\n- Use Nix/devenv to ensure a consistent environment (no brew).\n- Run the same gates as local: `./scripts/check.sh`.\n- Keep runtime stable: tests must be deterministic and not require external services by default.","acceptance_criteria":"Acceptance\n- CI workflow exists and runs on PRs and pushes to main.\n- Workflow runs `./scripts/check.sh` successfully in a clean runner.\n- CI does not require secrets for default test run.\n\nNotes\n- It is OK to skip macOS initially; start with ubuntu-latest unless there is a strong reason.","status":"open","priority":1,"issue_type":"chore","created_at":"2025-12-18T16:59:30.016481+01:00","updated_at":"2025-12-18T16:59:30.016481+01:00","dependencies":[{"issue_id":"xuezh-tfz","depends_on_id":"xuezh-1u6","type":"blocks","created_at":"2025-12-18T16:59:30.019295+01:00","created_by":"daemon"}]}
{"id":"xuezh-tgp","title":"P-02: Remove report.progress from tickets (YAGNI)","description":"Goal\n- Remove the stray `xuezh report progress` command mention so the contract remains the single source of truth.\n\nContext\n- `tickets/T-07.md` currently mentions `report progress` but the authoritative contract does not define it.\n\nScope\n- Remove `report progress` from `tickets/T-07.md` deliverables/acceptance.\n- Ensure no other doc/spec/skill references a non-existent `report.progress` command.\n- Keep UR-07 satisfied via existing surfaces (snapshot + reports + events) without adding a new CLI command.\n\nNon-goals\n- Do not add a `report.progress` command to the CLI contract in v1.","acceptance_criteria":"- No remaining references to `report progress` / `report.progress` in repo text.\n- Contract sync tests still pass.\n- `./scripts/check.sh` passes.","status":"closed","priority":1,"issue_type":"chore","created_at":"2025-12-18T18:30:22.737786+01:00","updated_at":"2025-12-18T18:40:21.334997+01:00","closed_at":"2025-12-18T18:40:21.334997+01:00","close_reason":"Removed stray progress-report command mention so contract remains authoritative; check.sh passes.","dependencies":[{"issue_id":"xuezh-tgp","depends_on_id":"xuezh-670","type":"blocks","created_at":"2025-12-18T18:31:10.091754+01:00","created_by":"daemon"},{"issue_id":"xuezh-tgp","depends_on_id":"xuezh-46v","type":"parent-child","created_at":"2025-12-18T18:31:36.966803+01:00","created_by":"daemon"}]}
{"id":"xuezh-tv8","title":"Rename project/tooling from chlearn -\u003e xuezh","description":"Goal\n- Full rename: Python package, CLI binary, env vars, docs/specs/tests.\n\nScope\n- Rename package `chlearn` -\u003e `xuezh` (src layout, imports, module paths).\n- Rename CLI entrypoint `chlearn` -\u003e `xuezh` (pyproject scripts).\n- Rename env vars: `CHLEARN_*` -\u003e `XUEZH_*` (workspace + db path at minimum).\n- Update default workspace dir path to a new xuezh-specific location.\n- Update all docs/specs/skills/BDD strings that mention the command name.\n\nNon-goals\n- No functional feature implementation beyond keeping current stubs working under the new name.","design":"Implementation notes\n- Prefer a clean break (no alias binary) unless you explicitly decide to keep compatibility.\n- If changing workspace directory default, document the migration implications (this is a new project, so it should be fine).\n- Keep commit mechanical: rename + string updates; avoid unrelated refactors.","acceptance_criteria":"Acceptance\n- `python -m pip install -e .[dev]` installs a runnable `xuezh` CLI.\n- `xuezh version --json` returns a valid OK envelope (schema-valid).\n- All BDD feature files invoke `xuezh ...` (no `chlearn` references).\n- `specs/cli/contract.json` + `docs/cli-contract.md` updated to `xuezh` and still pass contract sync tests.\n- No remaining `chlearn` imports or `CHLEARN_` env var usage in source/tests/docs (except possibly historical notes explicitly called out).\n\nValidation\n- Run `./scripts/check.sh` in devenv.","notes":"Rename changes committed, but validation is blocked until devenv is fixed (see xuezh-1u6).","status":"blocked","priority":1,"issue_type":"chore","created_at":"2025-12-18T16:59:07.51651+01:00","updated_at":"2025-12-18T17:12:12.379489+01:00"}
{"id":"xuezh-vso","title":"P-05: Time/window semantics + deterministic clock override","description":"Goal\n- Make time-window commands deterministic and testable without debating calendar semantics.\n\nScope\n- Document window parsing semantics used across commands:\n  - `Nd` / `Nh` are rolling durations (e.g. `30d` = now_utc - 30*24h)\n  - all stored timestamps are UTC ISO-8601\n- Add a single clock abstraction in code (e.g. `xuezh.core.clock.now_utc()`), with an env override for tests (e.g. `XUEZH_TEST_NOW_ISO`).\n- Add unit tests proving window parsing and clock override behavior.\n\nNon-goals\n- No feature implementation of snapshot/reports; just shared primitives and docs.","acceptance_criteria":"- Spec documents rolling-duration semantics and UTC requirement.\n- Clock helper exists with test override.\n- Unit tests cover parsing + override.\n- `./scripts/check.sh` passes.","status":"open","priority":1,"issue_type":"chore","created_at":"2025-12-18T18:30:47.974963+01:00","updated_at":"2025-12-18T18:30:47.974963+01:00","dependencies":[{"issue_id":"xuezh-vso","depends_on_id":"xuezh-dpn","type":"blocks","created_at":"2025-12-18T18:31:20.487628+01:00","created_by":"daemon"},{"issue_id":"xuezh-vso","depends_on_id":"xuezh-46v","type":"parent-child","created_at":"2025-12-18T18:31:50.73907+01:00","created_by":"daemon"}]}
{"id":"xuezh-ylw","title":"Clean up contract/spec/skill drift and tighten lint","description":"Goal\n- Remove small inconsistencies so the repo is “idiot-proof” before implementation starts.\n\nScope (examples already observed)\n- Align tickets vs contract: remove/adjust references to commands not in `specs/cli/contract.json` (e.g. `report progress`).\n- Fix Skill examples to use valid item IDs (per `specs/id-scheme.md`) and current CLI flags.\n- Eliminate obvious lint issues that will break `./scripts/check.sh` once devenv works (unused imports, formatting).\n- Ensure docs/README/workspace/env var docs match the renamed tool + backend selection rules.\n\nNon-goals\n- No feature logic beyond keeping the scaffold consistent and checkable.","acceptance_criteria":"Acceptance\n- `./scripts/check.sh` passes locally (in devenv).\n- No drift between `docs/cli-contract.md`, `specs/cli/contract.json`, `schemas/`, `specs/bdd/`, and Skill references.\n- Skill examples are copy/paste-able and use valid IDs/flags.","status":"open","priority":1,"issue_type":"chore","created_at":"2025-12-18T16:59:49.628522+01:00","updated_at":"2025-12-18T16:59:49.628522+01:00","dependencies":[{"issue_id":"xuezh-ylw","depends_on_id":"xuezh-oex","type":"blocks","created_at":"2025-12-18T16:59:49.631665+01:00","created_by":"daemon"}]}
